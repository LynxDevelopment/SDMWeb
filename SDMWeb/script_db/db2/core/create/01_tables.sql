CREATE TABLE TB_EVENT_TYPE (
       TYPE_ID              INTEGER NOT NULL,
       DESCRIPTION          VARCHAR(250),
       CONSTRAINT PK_TABENVEVENTTYPE PRIMARY KEY (TYPE_ID)
);


CREATE TABLE TB_EVENTS (
       EVENT_TIME           TIMESTAMP NOT NULL,
       USER_ID              VARCHAR(20) NOT NULL,
       TYPE_ID              INTEGER,
       DESCRIPTION          VARCHAR(250),
       CONSTRAINT PK_TB_ENV_EVENTS PRIMARY KEY (EVENT_TIME, USER_ID)
);

CREATE TABLE TB_FUNCTION_GROUPS (
       GROUP_ID             VARCHAR(50) NOT NULL,
       FUNCTION_ID          VARCHAR(50) NOT NULL,
       MODULE_ID            VARCHAR(50) NOT NULL,
       CONSTRAINT PK_FUNCTION_GROUPS PRIMARY KEY (GROUP_ID, FUNCTION_ID, MODULE_ID)
);


CREATE TABLE TB_FUNCTIONS (
       FUNCTION_ID          VARCHAR(50) NOT NULL,
       MODULE_ID            VARCHAR(50) NOT NULL,
       FUNCTION_URI         VARCHAR(250),
       FUNCTION_TITLE       VARCHAR(250),
       WF_MGR_AUTO          INTEGER,
       CONSTRAINT PK_TB_FUNCTIONS PRIMARY KEY (FUNCTION_ID, MODULE_ID)
);

CREATE TABLE TB_GROUP_TYPES (
       GROUP_TYPE           INTEGER NOT NULL,
       DESCRIPTION          VARCHAR(200),
       ADMIN_PAGE_URL		VARCHAR(100) NOT NULL,
       CLASSNAME			VARCHAR(100),
       CONSTRAINT PK_TB_GROUP_TYPES PRIMARY KEY (GROUP_TYPE)
);


CREATE TABLE TB_GROUPS (
       GROUP_ID             VARCHAR(50) NOT NULL,
       GROUP_TYPE           INTEGER,
       DESCRIPTION          VARCHAR(200),
       RULE		            VARCHAR(500),
       CONSTRAINT PK_TB_GROUPS PRIMARY KEY (GROUP_ID)
);


CREATE TABLE TB_MENU_ITEM_GROUP (
       MENU_ITEM_ID         VARCHAR(256) NOT NULL,
       GROUP_ID             VARCHAR(50) NOT NULL,
       CONSTRAINT PK_MENU_ITEM_GROUP PRIMARY KEY (MENU_ITEM_ID, GROUP_ID)
);


CREATE TABLE TB_MENU_ITEMS (
       MENU_ITEM_ID         VARCHAR(256) NOT NULL,
       LANGUAGE_ID          VARCHAR(2) NOT NULL,
       PARENT               VARCHAR(256),
       POSITION             INTEGER DEFAULT 1,
       MENU_ITEM_TITLE      VARCHAR(250),
       URL                  VARCHAR(250),
       ENABLED              VARCHAR(1) DEFAULT 'T' NOT NULL
                                   CONSTRAINT CHK_MARKED
                                          CHECK (ENABLED IN ('T','F')),
       MARKED               VARCHAR(1) DEFAULT 'F' NOT NULL
                                   CONSTRAINT CHK_ENABLED
                                          CHECK (MARKED IN ('T','F')),
       ICON1                VARCHAR(250),
       ICON2                VARCHAR(250),
       ITEM_TYPE			VARCHAR(20),
       OBJ_TYPE             INTEGER DEFAULT 0 NOT NULL,
       CONSTRAINT PK_TB_MENU_ITEMS PRIMARY KEY (MENU_ITEM_ID)
);


CREATE TABLE TB_MODULE_TYPES (
       MODULE_TYPE          INTEGER NOT NULL,
       DESCRIPTION          VARCHAR(200),
       CONSTRAINT PK_TB_MODULE_TYPE PRIMARY KEY (MODULE_TYPE)
);


CREATE TABLE TB_MODULES (
       MODULE_TYPE          INTEGER,
       ADMIN_URI            VARCHAR(200),
       MODULE_TITLE         VARCHAR(250),
       MODULE_ID            VARCHAR(50) NOT NULL,
       CONTENT_LOCATION     VARCHAR(100),
       DESCRIPTION          VARCHAR(200),
       ICON1				VARCHAR(250),
       ICON2				VARCHAR(250),
       CONSTRAINT PK_TB_MODULES PRIMARY KEY (MODULE_ID)
);

CREATE TABLE TB_PAGES (
       ACCESS_TIME          TIMESTAMP NOT NULL,
       PAGE_NAME            VARCHAR(80) NOT NULL,
       SEQUENCE_NUMBER      INTEGER NOT NULL,
       TRACKING_ID          INTEGER NOT NULL,
       REFERRER             VARCHAR(80),
       QUERY_STRING         VARCHAR(80),
       CONSTRAINT PK_TB_PAGES PRIMARY KEY (SEQUENCE_NUMBER, TRACKING_ID)
);

CREATE TABLE TB_USER_GROUP (
       GROUP_ID             VARCHAR(50) NOT NULL,
       USER_ID              VARCHAR(20) NOT NULL,
       CONSTRAINT PK_TB_USER_GROUP PRIMARY KEY (GROUP_ID, USER_ID)
);

CREATE TABLE TB_USER_PROFILES (
       USER_ID              VARCHAR(20) NOT NULL,
       PASSWORD             VARCHAR(50),
       FIRSTNAME            VARCHAR(50),
       LASTNAME             VARCHAR(50),
       EMAIL                VARCHAR(40),
       LANGUAGE				CHAR(2) DEFAULT 'it',
	   COUNTRY 				CHAR(2) DEFAULT 'IT',
       PHONE                VARCHAR(20),
       ADDRESS              VARCHAR(50),
       CITY                 VARCHAR(50),
       PROV                 VARCHAR(4),
       ZIPCODE              VARCHAR(10),
       STATE          		VARCHAR(20),
       MOBILE               VARCHAR(20),
       FAX                  VARCHAR(20),
       BIRTHDATE	        DATE,
       GENDER               CHAR(1),
       EXPIRATION_DATE		DATE,
       USER_TABLE_NAME      VARCHAR(50),
       ID_USER_STATUS       INTEGER,
       HOMEPAGE             VARCHAR(255),
       USER_TYPE            VARCHAR(20) DEFAULT 'XWEB_USER',
       PASSWORD_EXPIRATION_DATE DATE,
       CONSTRAINT PK_USER_PROFILES PRIMARY KEY (USER_ID)
);


CREATE TABLE TB_USER_STATUS (
       ID_USER_STATUS       INTEGER NOT NULL,
       DESCRIPTION          VARCHAR(200) NOT NULL,
       CONSTRAINT PK_TB_USER_STATUS PRIMARY KEY (ID_USER_STATUS)
);


CREATE TABLE TB_USER_TYPE (
       TYPE                 VARCHAR(20) NOT NULL,
       CLASSNAME            VARCHAR(100),
       CONSTRAINT PK_TB_USER_TYPE PRIMARY KEY (TYPE)
);

CREATE TABLE TB_TRACKING (
       USER_ID              VARCHAR(20),
       SESSION_ID           VARCHAR(100) NOT NULL,
       SESSION_START        TIMESTAMP NOT NULL,
       SESSION_END          TIMESTAMP,
       TRACKING_ID          INTEGER NOT NULL,
       UNIQUE_IP            VARCHAR(15),
       PLATFORM             VARCHAR(50),
       SCREEN_SIZE          VARCHAR(15),
       BROWSER              VARCHAR(50),
       USER_AGENT           VARCHAR(150),
       BROWSER_NAME         VARCHAR(30),
       BROWSER_VERSION      VARCHAR(5),
       CONSTRAINT PK_TB_TRACKING PRIMARY KEY (TRACKING_ID)
);

/*** Tabelle per statistiche ***/
CREATE TABLE TB_CALENDAR (
	CALENDAR_DATE 			TIMESTAMP NOT NULL,
	DAY 					INTEGER NOT NULL,
	MONTH 					INTEGER NOT NULL,
	YEAR 					INTEGER NOT NULL,
	NOTE 					VARCHAR(100),
	CONSTRAINT PK_TB_CALENDAR PRIMARY KEY (CALENDAR_DATE)
);

CREATE TABLE TB_CALENDARS (
	CALENDAR_ID 			VARCHAR(30) NOT NULL,
	DESCRIPTION 			VARCHAR(255),
	CONSTRAINT PK_TB_CALENDARS PRIMARY KEY (CALENDAR_ID)
);

CREATE TABLE TB_SPECIAL_DATES (
	CALENDAR_DATE 			TIMESTAMP NOT NULL,
	CALENDAR_ID 			VARCHAR(30) NOT NULL,
	NOTE 					VARCHAR(255),
	CONSTRAINT PK_SPECIAL_DATES PRIMARY KEY (CALENDAR_DATE, CALENDAR_ID)
);

CREATE TABLE TB_HOURS_OF_DAY (
	HOUR 					VARCHAR(2),
	MINUTE 					VARCHAR(2)
);

CREATE TABLE TB_USER_PROPERTY (
	USER_ID					VARCHAR(20) NOT NULL,
	PROPERTY_NAME			VARCHAR(20) NOT NULL,
	VALUE					VARCHAR(255),
	CONSTRAINT PK_USER_PROPERTY PRIMARY KEY (USER_ID, PROPERTY_NAME)
);


CREATE TABLE TB_RESOURCE_COLLECTION (
		COLLECTION_NAME			VARCHAR(20) NOT NULL,
		DESCRIPTION				VARCHAR(200),
		URL_PATTERN				VARCHAR(200) NOT NULL,
		CONSTRAINTS_ENABLED		INTEGER DEFAULT 0 NOT NULL,
		CONSTRAINT PK_RES_COLLECTION PRIMARY KEY (COLLECTION_NAME)
);

CREATE TABLE TB_SECURITY_CONSTRAINT (
		COLLECTION_NAME			VARCHAR(20) NOT NULL,
		GROUP_ID				VARCHAR(50) NOT NULL,
		CONSTRAINT PK_SEC_CONSTRAINTS PRIMARY KEY (COLLECTION_NAME, GROUP_ID)
);

CREATE TABLE TB_OLD_PASSWORDS (
	USER_ID		VARCHAR(20) NOT NULL,
	PASSWORD	VARCHAR(50) NOT NULL,
	PASSWORD_TIMESTAMP	TIMESTAMP NOT NULL,
	CONSTRAINT PK_OLD_PASSWORDS PRIMARY KEY (USER_ID, PASSWORD, PASSWORD_TIMESTAMP)	
);